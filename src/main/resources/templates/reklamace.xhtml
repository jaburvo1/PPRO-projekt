<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
        PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <link rel="stylesheet" href="/styll.css"/>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Reklamace</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js" type="javascript"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js" type="text/javascript"></script>

    <script type="text/javascript">
        function submit() {

            if(document.getElementById("addReklamace").checked==true){

                console.log("ok");
                addReklamace();

            }
            else{
                if (document.getElementById("editReklamace").checked==true){
                    console.log("ok");

                }
                else {
                    alert("vyrbat typ akce")
                }

            }

        };
        async function   addReklamace() {
            const kodReklamace = document.getElementById("kodReklamace").value;
            const popisReklamace = document.getElementById("popisReklamace").value;
            const datumVytvoreni = document.getElementById("datumVytvoreni").value;
            if((kodReklamace=="")||(popisReklamace=="")||(datumVytvoreni=="")){
                alert("nevpynena pole kodReklamace, popisReklamace a datumVytvoreni, ebo jedon znich")
            }
            else {
                var stav;
                if (document.getElementById("stavPrijato").checked == false) {
                    alert("nova reklamace musi mit stav prijato satav prenastaven")
                    stav = 1;

                } else {
                    stav = 1;
                }
                console.log(stav);

                var klient
                if (document.getElementById("klient1").checked == true) {
                    klient = 1;
                } else {
                    if (document.getElementById("klient2").checked == true) {
                        klient = 2;
                    } else {
                        if (document.getElementById("klient3").checked == true) {
                            klient = 3;
                        } else {
                            klient = 0;
                        }
                    }
                }
                if (klient == 0) {
                    alert("klinet nevybran")
                } else {


                    //const response = await axios.post('http://localhost:8080/novaRekalamace', data)
                    //const kodReklamace =response.data.kodReklamace;
                    //var axios = require('axios');
                    //var FormData = require('form-data');
                    var dataBody = new FormData();
                    dataBody.append('kodReklamace', kodReklamace);
                    dataBody.append('popisReklamace', popisReklamace);
                    dataBody.append('datumVytvorení', datumVytvoreni);
                    dataBody.append('client', klient);
                    dataBody.append('stavReklamace', stav);

                    var status;
                    var config = {
                        method: 'post',
                        url: 'http://localhost:8080/novaRekalamace',
                        headers: {
                            //...dataBody.getHeaders()
                        },
                        data: dataBody
                    };

                    axios(config)
                        .then(function (response) {
                            console.log(JSON.stringify(response.data));
                            status = response.status;
                        })
                        .catch(function (error) {
                            console.log(error);
                            status = error.status;
                        })
                    document.getElementById("status").value = status;
                    document.getElementById("status").disabled = false;

                }
            }
        };
        async function editRekalamce(){
/*
            const data = { kodReklamace: document.getElementById("kodReklamace").value,
                infoReklamace: document.getElementById("infoReklamace").value,
                datumVyreseni: document.getElementById("datumVyreseni").value,
                stavReklamace: stav
*/

           const  kodReklamace = document.getElementsByClassName("kodReklamace");
           var stav = $(".stav:checked").val();
           var axios = require('axios');
            var FormData = require('form-data');
            var dataBody = new FormData();
            dataBody.append('kodReklamace', document.getElementById("kodReklamace"));
            dataBody.append('infoReklamace', document.getElementById("infoReklamace"));
            dataBody.append('datumVyreseni', document.getElementById("datumVyreseni"));
            dataBody.append('stavReklamace', stav);

            var config = {
                method: 'patch',
                //url: 'http://localhost:8080/editRekalamace',
                url: 'http://127.0.0.1:8080/reklamaceR',
                headers: {
                    //...dataBody.getHeaders()
                },
                data : dataBody
            };

            axios(config)
                .then(function (response) {
                    console.log(JSON.stringify(response.data));
                })
                .catch(function (error) {
                    console.log(error);
                });

        };
        async function getReklamaceR() {
            var config = {
                method: 'get',
                //url: 'http://localhost:8080/reklamaceR',
                url: 'http://127.0.0.1:8080/reklamaceR',
                headers: {}
            };

            axios(config)
                .then(function (response) {
                    console.log(JSON.stringify(response.data));
                    return response.data
                })
                .then(function (response) {
                    console.log(JSON.stringify(response.data));
                    return response.date;
                })
                .catch(function (error) {
                   // console.log(error);
                });
        }
        async function getReklamaceA() {
            var config = {
                method: 'get',
                //url: 'http://localhost:8080/reklamace',
                url: 'http://127.0.0.1:8080/reklamaceA',
                headers: {}
            };

            axios(config)
                .then(function (response) {
                    console.log(JSON.stringify(response.data));
                    return response.date;
                })
                .catch(function (error) {
                    //console.log(error);
                });
        }
        async function getReklamaceS() {
            var config = {
                method: 'get',
                //url: 'http://localhost:8080/reklamace',
                url: 'http://127.0.0.1:8080/reklamaceS',
                headers: {}
            };

            axios(config)
                .then(function (response) {
                    console.log(JSON.stringify(response.data));
                    return response.data
                })
                .catch(function (error) {
                    //console.log(error);
                    return error;
                });
        }
        async function readReklamace(){
           const  {reklamaceA} =getReklamaceA();
           const  {reklamaceR} =getReklamaceR();
           const  {reklamaceS} =getReklamaceS();


        }

        function submitR()
        {
            console.log("ok");
        }
        function copy(reklamace) {

            var reklamaceCopy = reklamace.getAttribute("data-reklamace-type");
            document.getElementById("kodReklamace").value=reklamaceCopy
        }



</script>


</head>
<body>
<div class="form">
    <label>správa uživatelů</label>
    <br/>
    <label for="kodReklamace">kod reklamace:</label>
    <input type="text" id="kodReklamace" name="kodReklamace"/>
    <br/>
    <label for="popisReklamace">popis</label>
    <input type="text" id="popisReklamace" name="popisReklamace" />
    <br/>
    <label for="infoReklamace">infromace o reklamaci</label>
    <input type="text" id="infoReklamace" name="infoReklamace"/>
    <br/>
    <label for="datumVytvoreni">dastum vytvoreni</label>
    <input type="text" id="datumVytvoreni" name="datumVytvoreni"/>
    <br/>
    <label for="datumVyreseni">datum vyreseni:</label>
    <input type="text" id="datumVyreseni" name="datumVyreseni"/>
    <br/>
    <label>stav:</label>
    <br/>
    <label>prijato: </label>
    <input type="radio" id="stavPrijato" name="stavReklamace" class="stav" value="prijato"/>
    <label>vyrizeno: </label>
    <input type="radio" id="stavVyrizeno" name="stavReklamace" class="stav" value="vyrizeno"/>
    <label>zamitnuto:</label>
    <input type="radio" id="stavZmitnuto" name="stavReklamace" class="stav" value="zamitnuto"/>
    <br/>
    <label>typ akce:</label>
    <br/>
    <label>nova reklamace</label>
    <input type="radio" id="addReklamace" name="typAkce" class="typAkce" value="rkelamace"/>
    <label>uprava stavu reklamace</label>
    <input type="radio" id="editReklamace" name="typAkce"  class="typAkce" value="sklad"/>

    <br/>
    <label>klient:</label>
    <br/>
    <label>klient1</label>
    <input type="radio" id="klient1" name="klient" class="klient" value="1"/>
    <label>klient2</label>
    <input type="radio" id="klient2" name="klient"  class="klient" value="2"/>
    <label>klient3</label>
    <input type="radio" id="klient3" name="klient"  class="klient" value="3"/>
    <br/>
    <button onclick="submit()">ok</button>
    <button type="reset" id="delete" name="delete">vymaž</button>
    <br/>
    <input type="text" id="status" name="status" disabled="disabled"/>
</div>

<div class="vypisRekalamci">

    <button type="button" id="nactiReklamace" name="nactiReklamace" ondblclick="readReklamace()">ZobarazReklamace</button>
    <p>prijate:</p>
    <ul>
        <li onclick="copy(this)" id="A" data-reklamace-type="ok">1</li>
        <li onclick="copy(this)" id="S" data-reklamace-type="?">2</li>
        <li onclick="copy(this)" id="R" data-reklamace-type="no">3</li>
    </ul>
    <p>vyřízené:</p>
    <ul>
        <li onclick="copy(this)" id="A" data-reklamace-type="ok">1</li>
        <li onclick="copy(this)" id="S" data-reklamace-type="?">2</li>
        <li onclick="copy(this)" id="R" data-reklamace-type="no">3</li>
    </ul>
    <p>zamitnuté:</p>
    <ul>
        <li onclick="copy(this)" id="A" data-reklamace-type="ok">1</li>
        <li onclick="copy(this)" id="S" data-reklamace-type="?">2</li>
        <li onclick="copy(this)" id="R" data-reklamace-type="no">3</li>
    </ul>
</div>

</body>
</html>