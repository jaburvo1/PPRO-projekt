<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
        PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <link rel="stylesheet" href="/styll.css"/>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Sklad</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js" type="text/javascript"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js" type="text/javascript"></script>
    <script type="text/javascript">

        const url = "http://127.0.0.1:8080/";
        function submit(){
            const typAkce = $(".skladDil:checked").val();
            if(typAkce==1){
                novyDill();
            }
            else {
                if(typAkce==2){

                    naskladniDil();
                }
                else {
                    vyskladniDil();
                }
            }
            reload();
        }
        async function   novyDill(){
            const data = {
                nazevDilu: document.getElementById("nazevDilu").value,
                druhDilu: document.getElementById("druhDilu").value,
                typDilu: document.getElementById("typDilu").value,
                parametryDilu: document.getElementById("parametryDilu").value,
                vyrobceDilu: document.getElementById("vyrobceDilu").value,
                pocetKusu: document.getElementById("pocetKusu").value,

            };
            const response = await axios.post('https://localhost:8080/addItem', data);
            const dil =response.data.nazevDilu;
        }

        async function naskladniDil(){

            const data = {
                nazevDilu: document.getElementById("nazevDilu").value,
                pocetKusu: document.getElementById("pocetKusu").value,
            };
            const response = await axios.patch('https://localhost:8080/addItemPiece', data);
            const dil =response.data.nazevDilu;

        }

        async function vyskladniDil(){
            const namePart = document.getElementById("nazevDilu").value;
            const countPart = document.getElementById("pocetKusu").value;

            if((namePart=="")||(countPart=="")){
                alert("musi byt vypneno nzev dilu a pocet kusu")
            }
            else
            {
                var dataBody = new FormData();
                dataBody.append('nazevdilu', namePart);
                dataBody.append('pocetKusu', countPart);

                var config = {
                    method: 'post',
                    //url: 'http://localhost:8080/removeItemPiece',
                    url: ''+url+'removeItemPiece',
                    headers: {
                        //...dataBody.getHeaders()
                    },
                    data: dataBody
                };

                axios(config)
                    .then(function (response) {
                        console.log(JSON.stringify(response.data));
                    })
                    .catch(function (error) {
                        console.log(error);
                    });
            }

        }

        async function reload(){
            const result = getSklad();
            console.log(result);
            console.log("ok");
        }

        function getSklad(){
            var config = {
                method: 'get',
                url: 'http://localhost:8080/sklad',
                headers: { }
            };

            axios(config)
                .then(function (response) {
                    console.log(JSON.stringify(response.data));
                })
                .catch(function (error) {
                    console.log(error);
                });
        }
        function copyFrom(){
            document.getElementById("nazevDilu").innerText="ok";
            console.log("ok");

        }

    </script>
</head>
<body>

<div class="form">
    <label>správa uživatelů</label>
    <br/>
    <label for="nazevDilu">nazev dilu:</label>
    <input type="text" id="nazevDilu" name="nazevDilu"/>
    <br/>
    <label for="druhDilu">druh dilu:</label>
    <input type="text" id="druhDilu" name="druhDilu"/>
    <br/>
    <label for="typDilu">typ dilu:</label>
    <input type="text" id="typDilu" name="typDilu"/>
    <br/>
    <label for="parametryDilu">parametry dilu:</label>
    <input type="text" id="parametryDilu" name="parametryDilu"/>
    <br/>
    <label for="vyrobceDilu">vyrobce dilu:</label>
    <input type="text" id="vyrobceDilu" name="vyrobceDilu"/>
    <br/>
    <label for="pocetKusu">pocet kusu:</label>
    <label for="pocetKusu"></label><input type="text" id="pocetKusu" name="pocetKusu"/>
    <br/>
    <label>akce:</label>
    <br/>
    <label>novyDil</label>
    <input type="radio" id="novyDil" name="skladDil" class="skladDil" value="novyDil"/>
    <label>naskladnit</label>
    <input type="radio" id="naskladnitDil" name="skladDil" class="skladDil" value="naskladnit"/>
    <label>vyskladnit</label>
    <input type="radio" id="vyskladnitDil" name="skladDil" class="skladDil" value="vyskladnit"/>
    <br/>
    <button type="button" id="ok" name="ok" ondblclick="submit()">ok</button>
    <button type="reset" id="delete" name="delete" >vymaž</button>

</div>
<div class="vypisSklad">
    <button type="button" id="edit" name="edit" ondblclick="copyFrom()">edit</button>
    <button type="button" id="nactiSklad" name="nactiSklad" ondblclick="reload()">ZobarazSklad</button>
</div>
</body>
</html>